#Please run this in a linux system
#You might need to install dependencies (pip install yara-python watchdog)
#Untested as my linux system (kali) does not install python dependencies system-wide due to the apt and pip overlap
import yara
import time
from watchdog.observers import Observer
from watchdog.events import FileSystemEventHandler
rulesfile = wget https://bazaar.abuse.ch/export/yara #This is where you assign the malware list you get from yara or anywhere else. My method might not work
rules = yara.compile(filepath=rulesfile)
monitorpath = "/" #Monitor the entire file system
class malwarescanner(FileSystemEventHandler):
    def on_created(self, event):
        if not event.is_directory:
            print(f"[+] New file detected: {event.src_path}")
            matches = rules.match(event.src_path)
            if matches:
                print(f"[ALERT] Malware detected in {event.src_path}: {matches}")
                
observer = Observer()
event_handler = MalwareScanner()
observer.schedule(event_handler, WATCH_DIR, recursive=True)
observer.start()

try:
    while True:
        time.sleep(1)
except KeyboardInterrupt:
    observer.stop()
observer.join()

